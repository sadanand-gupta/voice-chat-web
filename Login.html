<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Tectalik</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
           <meta
            content="importance of performance management, performance management system in india, 
               performance management process, employee performance, employee performance evaluation,
               employee performance appraisal, employee performance management system, employee incentive, employee incentive rewards,
               employee incentive software, incentives and rewards, incentives and rewards for employees, Performance management,
               human resource management, human resource managemen system, appraisals and incentives, incentives and bonus, 
               Balanced scorecards, balanced scorecard framework, hr balanced scorecard, performance management in chennai, 
               performance management and hrms, key performance indicators, Employee goal setting, Manager rating system, 
               checklists and task manager, assortment planning, retail assortment planning, merchandise assortment planning,
               assortment retail, assortment merchandise, merchandise and assortment planning, assortment planning software, 
               assortment planning tools, retail assortment planning software, best assortment planning software, 
               assortment management in retail, merchandise allocation, leading merchandise planning and allocation,
                merchandise planning and allocation software, merchandise planning and allocation solutions, 
                merchandise planning and allocation system, merchandiser allocator, merchandising allocator, 
                merchandising planning and allocation, product assortment planning, assortment planning best practices, 
                assortment planning process in retail, assortment planning process, assortment planning in merchandising,
                assortment planning in retail, business health check, business health check tool, company health check up,
                business health report, business health check up, how to do a business health check, 
                how to check business health, health check for business, business financial health check, 
                health check in business, google my business health checkup, business process health check,
                health check process, business health score assessment, business health check tool, corporate health check up, 
                corporate annual health check up, company annual health check up, what is business health check,
                360 degree health check, complete business check, business check"
            name="keywords">
    <meta content name="description">

    <!-- Favicon -->
    <link href="img/favicon.png" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
        rel="stylesheet">
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
        rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css"
        rel="stylesheet">
    <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
            <link href="css/style.css" rel="stylesheet">
        <!-- Google Tag Manager -->
       <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-T246HX8C');</script>
        <!-- End Google Tag Manager -->
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y7GW5P8B7B"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-Y7GW5P8B7B');
        </script>
    <style>
        @font-face {
            font-family: Axiforma-Medium;
            src: url("../assets/font/Axiforma-Medium.ttf");
        }

        body {
            margin: 0;
            padding: 0;
            background: #f4f5f6;
            color: rgb(29, 34, 38);
            font-family: Axiforma-Medium, sans-serif;
            background: url("img/webpage1.png") no-repeat center center;
        }

        .container {
            min-height: 95vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card {
            width: 400px;
            max-height: 610px;
            text-align: center;
            border-radius: 10px;
            margin-top: 50px;
            padding: 20px;
            background: #050c44;
            color: white;
        }

        .logo {
            max-height: 55px;
            max-width: 177px;
            margin: 20px auto;
        }

        .login-title {
            font-size: 20px;
            margin-top: 30px;
            color: white;
        }

        .input-field {
            width: 360px;
            height: 44px;
            margin: 10px auto;
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #ccc;
            background-color: white;
            font-size: 14px;
            font-family: Axiforma-Medium;
        }

        .password-field {
            position: relative;
        }

        .password-toggle {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #666;
        }

        .submit-button {
            width: 360px;
            height: 44px;
            margin-top: 20px;
            border-radius: 6px;
            font-size: 14px;
            font-family: Axiforma-Medium;
            background-color: white;
            color: #050c44;
            border: none;
            cursor: pointer;
        }

        .links {
            font-size: 14px;
            margin-top: 20px;
            cursor: pointer;
        }

        .links a {
            color: white;
            text-decoration: none;
        }

        .switch {
            margin-top: 20px;
        }

        @media (max-width: 576px) {
            .card {
                width: 100%;
                height: 100vh;
                margin: 0;
                border-radius: 0;
            }

            .input-field {
                width: 90%;
            }

            .submit-button {
                width: 90%;
            }
        }
    </style>
</head>
<body>
    <div id="spinner"
    class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
    <div class="spinner-border position-relative text-primary"
        style="width: 6rem; height: 6rem;" role="status">
    </div>
    <img src="img/tectalik_small_transparent1.png" 
        class="position-absolute top-50 start-50 translate-middle" 
        style="width: 3rem; height: 3rem;" 
        alt="Loading">
</div>
    <div class="container">
        <div class="card">
            <img src="img/logo-dark.png" alt="Logo" class="logo">
            <h2 class="login-title">Login to Tectalik</h2>
            
            <form id="loginForm" onsubmit="handleSubmit(event)">
                <input type="email" class="input-field" placeholder="Email or Username" id="email" required>
                
                <div class="password-field">
                    <input type="password" class="input-field" placeholder="Password" id="password" required>
                    <span class="password-toggle mdi mdi-eye" onclick="togglePassword()"></span>
                </div>
                
                <div id="subdomainField">
                    <input type="text" class="input-field" placeholder="Sub Domain" id="subdomain"
                    oninput="validateInput(this)">
                </div>

                <button type="submit" class="submit-button">SUBMIT</button>
            </form>

            <div class="links">
                <a href="#" onclick="handleForgot()">Not able to log in?</a> |
                <a href="#">Contact us</a>
            </div>

            <div class="switch">
                <label>
                    <!-- <input type="checkbox" onchange="toggleTheme()">
                    Toggle theme -->
                </label>
            </div>
        </div>
    </div>

    <script>
        // Check if subdomain input should be shown
        const domain = window.location.host.split('.');
        if (domain.length === 0 || domain[0] === 'localhost') {
            document.getElementById('subdomainField').style.display = 'block';
        }

        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const toggleButton = document.querySelector('.password-toggle');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleButton.classList.replace('mdi-eye', 'mdi-eye-off');
            } else {
                passwordInput.type = 'password';
                toggleButton.classList.replace('mdi-eye-off', 'mdi-eye');
            }
        }

        function toggleTheme() {
            const card = document.querySelector('.card');
            const loginTitle = document.querySelector('.login-title');
            const links = document.querySelectorAll('.links a');
            
            card.style.backgroundColor = card.style.backgroundColor === 'white' ? '#050c44' : 'white';
            card.style.color = card.style.color === 'black' ? 'white' : 'black';
            loginTitle.style.color = loginTitle.style.color === 'black' ? 'white' : 'black';
            
            links.forEach(link => {
                link.style.color = link.style.color === 'black' ? 'white' : 'black';
            });
        }

        function validateInput(input) {
        let value = input.value;
        if (/[A-Z]/.test(value)) {
            document.getElementById("subdomain").textContent = "Only lowercase letters are allowed!";
            input.value = value.toLowerCase(); // Convert uppercase to lowercase automatically
        } else {
            document.getElementById("subdomain").textContent = "";
        }
    }

      

//         function handleSubmit(event) {
//     event.preventDefault();

//     const email = document.getElementById('email').value.trim();
//     const password = document.getElementById('password').value.trim();
//     const subdomain = document.getElementById('subdomain')?.value?.trim();

//     if (!subdomain) {
//         alert("Please enter a subdomain.");
//         return;
//     }

//     // Construct the prefix using the entered subdomain
//     const prefix = `cmp_${subdomain}`;

//     // Login URL for obtaining the token and user id
//     const loginUrl = 'https://compliance-api.tectalik.com/api/sessions/login';

//     // Construct the login request payload
//     const loginData = {
//         email,
//         password,
//         prefix // using the constructed prefix value
//     };

//     // Login to get the token and user id
//     fetch(loginUrl, {
//         method: 'POST',
//         headers: {
//             'Content-Type': 'application/json'
//         },
//         body: JSON.stringify(loginData)
//     })
//     .then(response => {
//         if (!response.ok) {
//             throw new Error('Login failed');
//         }
//         return response.json();
//     })
//     .then(loginResponse => {
//         // Assuming the response returns a token and user id
//         const token = loginResponse.token;
//         const userId = loginResponse.user_id;  // Adjust as needed per your API response
//         console.log('Token received:', token);
//         console.log('User ID received:', userId);

//         // First call: Get features by role using the userId
//         const featuresApiUrl = `https://compliance-api.tectalik.com/tapi/get_features_by_role/${userId}`;
//         console.log('Calling features API at:', featuresApiUrl);

//         return fetch(featuresApiUrl, {
//             method: 'GET',
//             headers: {
//                 'Content-Type': 'application/json',
//                 'Authorization': `Bearer ${token}`
//             }
//         });
//     })
//     .then(response => {
//         if (!response.ok) {
//             throw new Error('Features API request failed');
//         }
//         return response.json();
//     })
//     .then(featuresData => {
//         console.log('Features API Response:', featuresData);
        
//         // Show a success popup when the API call succeeds.
//         // When the user clicks OK, navigate to the specified URL.
//         if (alert("Features API call successful!")) {}  // alert returns undefined
//         window.location.href = `https://${subdomain}.tectalik.com/show_list`;
//     })
//     .catch(error => {
//         console.error('Error:', error);
//         alert("An error occurred: " + error.message);
//     });
// }


function handleSubmit(event) {
    event.preventDefault();

    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();
    const subdomain = document.getElementById('subdomain')?.value?.trim();

    if (!subdomain) {
        alert("Please enter a subdomain.");
        return;
    }

    const prefix = `cmp_${subdomain}`;
    const loginUrl = 'https://compliance-api.tectalik.com/api/sessions/login';
    
    const loginData = { email, password, prefix };

    fetch(loginUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(loginData)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Login failed');
        }
        return response.json();
    })
    .then(loginResponse => {
        const token = loginResponse.token;
        const userId = loginResponse.user_id; 

        // Store data in sessionStorage for reuse after navigation
        sessionStorage.setItem('userToken', token);
        sessionStorage.setItem('userId', userId);
        sessionStorage.setItem('subdomain', subdomain);

        const featuresApiUrl = `https://compliance-api.tectalik.com/tapi/get_features_by_role/${userId}`;

        return fetch(featuresApiUrl, {
            method: 'GET',
            headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` }
        });
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Features API request failed');
        }
        return response.json();
    })
    .then(featuresData => {
        console.log('Features API Response:', featuresData);
        
        alert("Features API call successful!");

        // Redirect to the new page
        window.location.href = `https://${subdomain}.tectalik.com/show_list`;
    })
    .catch(error => {
        console.error('Error:', error);
        alert("An error occurred: " + error.message);
    });
}
document.addEventListener("DOMContentLoaded", function() {
    const email = sessionStorage.getItem('email');
    const password = sessionStorage.getItem('password');
    const subdomain = sessionStorage.getItem('subdomain');
    const prefix = `cmp_${subdomain}`;

    if (!email || !password || !subdomain) {
        console.error("Login details are missing in sessionStorage");
        return;
    }

    const loginUrl = 'https://compliance-api.tectalik.com/api/sessions/login';
    
    fetch(loginUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password, prefix })
    })
    .then(response => response.json())
    .then(loginResponse => {
        const token = loginResponse.token;
        const userId = loginResponse.user_id;

        sessionStorage.setItem('userToken', token);
        sessionStorage.setItem('userId', userId);

        const featuresApiUrl = `https://compliance-api.tectalik.com/tapi/get_features_by_role/${userId}`;

        return fetch(featuresApiUrl, {
            method: 'GET',
            headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` }
        });
    })
    .then(response => response.json())
    .then(featuresData => {
        console.log('Refreshed Features API Response:', featuresData);
    })
    .catch(error => {
        console.error('Error refreshing APIs:', error);
    });
});


    </script>
</body>
</html>